---
import { Image } from "astro:assets";
import slide1 from "../assets/hero/1.jpg";
import slide2 from "../assets/hero/2.jpg";
import slide3 from "../assets/hero/3.jpg";

const slides = [
  {
    image: slide1,
    alt: "Parze młoda w objęciach",
    title: "Miłość w każdym kadrze",
    subtitle: "Uwieczniamy emocje, które zostaną z Wami na zawsze.",
    buttonText: "Zobacz Portfolio",
    buttonLink: "/portfolio"
  },
  {
    image: slide2,
    alt: "Panna młoda z bukietem",
    title: "Naturalne Piękno",
    subtitle: "Subtelne, eleganckie i pełne wdzięku portrety.",
    buttonText: "O Nas",
    buttonLink: "/o-nas"
  },
  {
    image: slide3,
    alt: "Ceremonia ślubna",
    title: "Wasza Historia",
    subtitle: "Reportaż, który opowiada o Waszym najważniejszym dniu.",
    buttonText: "Zapytaj o termin",
    buttonLink: "/kontakt"
  },
];
---

<section class="relative h-screen w-full overflow-hidden">
  <!-- Slider Container -->
  <div class="absolute inset-0 w-full h-full" id="hero-slider">
    {
      slides.map((slide, index) => (
        <div
          class={`absolute inset-0 w-full h-full transition-opacity duration-[1500ms] ease-in-out ${index === 0 ? "opacity-100 z-10 active-slide" : "opacity-0 z-0"}`}
          data-slide={index}
        >
          <!-- Image -->
          <Image
            src={slide.image}
            alt={slide.alt}
            class="absolute inset-0 w-full h-full object-cover animate-ken-burns"
            loading={index === 0 ? "eager" : "lazy"}
            width={1920}
            quality={80}
            format="webp"
          />
          <div class="hero-overlay absolute inset-0 bg-black/30" />
          
          <!-- Content Overlay (Per Slide) -->
          <div class="relative z-20 h-full flex items-center justify-center text-center text-white px-6">
            <div class="hero-content">
              <h1 class="font-serif font-light tracking-[0.2em] mb-6">
                {slide.title}
              </h1>
              <p class="font-sans text-sm md:text-base tracking-[0.15em] mb-10 max-w-md mx-auto">
                {slide.subtitle}
              </p>
              <div>
                <a
                  href={slide.buttonLink}
                  class="btn-primary border-white text-white hover:bg-white hover:text-charcoal inline-block"
                >
                  {slide.buttonText}
                </a>
              </div>
            </div>
          </div>
        </div>
      ))
    }
  </div>

  <!-- Scroll indicator -->
  <div
    class="absolute bottom-8 left-1/2 -translate-x-1/2 flex flex-col items-center gap-2 text-white/70 z-20"
  >
    <div class="w-px h-12 bg-white/30"></div>
  </div>

  <!-- Social links -->
  <div
    class="hidden md:flex absolute left-8 bottom-8 items-center gap-4 text-white/70 text-xs tracking-wider z-20"
  >
    <a
      href="https://facebook.com/fiodorowphotography"
      target="_blank"
      class="hover:text-white transition-colors">FB</a
    >
    <span class="w-8 h-px bg-white/30"></span>
    <a
      href="https://instagram.com/fiodorow_photography"
      target="_blank"
      class="hover:text-white transition-colors">IG</a
    >
  </div>
</section>

<style>
  @keyframes ken-burns {
    0% {
      transform: scale(1) translate(0, 0);
    }
    100% {
      transform: scale(1.1) translate(-2%, 0);
    }
  }

<style>
  @keyframes ken-burns {
    0% {
      transform: scale(1) translate(0, 0);
    }
    100% {
      transform: scale(1.1) translate(-2%, 0);
    }
  }

  .animate-ken-burns {
    animation: ken-burns 20s ease-out infinite alternate;
  }
  
  /* Cinematic Reveal Animation */
  @keyframes cinematic-reveal {
    0% {
      opacity: 0;
      transform: translateY(40px) scale(0.95);
      filter: blur(12px);
    }
    100% {
      opacity: 1;
      transform: translateY(0) scale(1);
      filter: blur(0);
    }
  }

  /* Subtitle specific (softer blur) */
  @keyframes cinematic-slide {
    0% {
      opacity: 0;
      transform: translateY(30px);
      filter: blur(8px);
    }
    100% {
      opacity: 1;
      transform: translateY(0);
      filter: blur(0);
    }
  }

  /* Button specific (sharp slide) */
  @keyframes fade-slide-up {
    0% {
      opacity: 0;
      transform: translateY(20px);
    }
    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  /* Initial hidden state */
  .hero-content h1,
  .hero-content p,
  .hero-content div {
    opacity: 0;
  }

  /* Animation classes applied when parent has .active-slide */
  .active-slide .hero-content h1 {
    animation: cinematic-reveal 1.2s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    animation-delay: 0.3s;
  }
  
  .active-slide .hero-content p {
    animation: cinematic-slide 1.2s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    animation-delay: 0.6s;
  }
  
  .active-slide .hero-content div {
    animation: fade-slide-up 1s ease-out forwards;
    animation-delay: 0.9s;
  }
</style>

<script>
  // Simple Slider Logic
  const slides = document.querySelectorAll("[data-slide]");
  let currentSlide = 0;
  const slideCount = slides.length;
  const intervalTime = 6000; // 6 seconds per slide

  const nextSlide = () => {
    // Current slide fades out
    slides[currentSlide].classList.remove("opacity-100", "z-10", "active-slide");
    slides[currentSlide].classList.add("opacity-0", "z-0");
    
    // Reset animations in the outgoing slide explicitly if needed, 
    // but removing 'active-slide' class handles the CSS transition reset.

    // Next slide index
    currentSlide = (currentSlide + 1) % slideCount;

    // Next slide fades in
    slides[currentSlide].classList.remove("opacity-0", "z-0");
    void (slides[currentSlide] as HTMLElement).offsetWidth; // Trigger reflow to restart css transitions if faulty
    slides[currentSlide].classList.add("opacity-100", "z-10", "active-slide");
  };

  // Start loop
  if (slideCount > 1) {
    setInterval(nextSlide, intervalTime);
  }
</script>
